var HaberimdesinApp=angular.module("Haberimdesin",[]),habers=null,lastNew=null,last2News=null;HaberimdesinApp.controller("News",["$scope","$http",function(n,t){n.activeHaber=null;n.last2News=function(){return last2News};n.lastNew=function(){return lastNew};n.habers=function(){return habers};t.get("/haberimdesin/getCategories").success(function(t){n.categories=t.categories}).error(function(n){console.log(n)});n.getAllNews=function(){t.get("/haberimdesin/getAllNews").success(function(t){habers=t.newsList.reverse();lastNew=habers[0];last2News=habers.slice(1,3);n.activeHaber=null}).error(function(n){console.log(n)})};n.getAllNews();n.getNewsByCategory=function(i){var r="/haberimdesin/getNewsByID/"+i;t.get(r).success(function(t){last2News=null;lastNew=null;habers=t.newsList.reverse();n.activeHaber=null}).error(function(n){console.log(n)})};n.likeComment=function(i,r){var u=new FormData;u.append("id",i);t.post("/Haberimdesin/LikeComment",u,{transformRequest:angular.identity,headers:{"Content-Type":undefined}}).success(function(){n.yorumlar[r].like=n.yorumlar[r].like+1}).error(function(n){console.log(n)})};n.dislikeComment=function(i,r){var u=new FormData;u.append("id",i);t.post("/Haberimdesin/DislikeComment",u,{transformRequest:angular.identity,headers:{"Content-Type":undefined}}).success(function(){n.yorumlar[r].dislike=n.yorumlar[r].dislike+1}).error(function(n){console.log(n)})};n.likeNews=function(){var i=new FormData;i.append("id",n.activeHaber[0].haberID);t.post("/Haberimdesin/LikeNews",i,{transformRequest:angular.identity,headers:{"Content-Type":undefined}}).success(function(){n.activeHaber[0].like=n.activeHaber[0].like+1}).error(function(n){console.log(n)})};n.dislikeNews=function(){var i=new FormData;i.append("id",n.activeHaber[0].haberID);t.post("/Haberimdesin/DislikeNews",i,{transformRequest:angular.identity,headers:{"Content-Type":undefined}}).success(function(){n.activeHaber[0].dislike=n.activeHaber[0].dislike+1}).error(function(n){console.log(n)})};n.getNewsDetail=function(i){window.scrollTo(0,0);var r="/haberimdesin/getNewsDetail/"+i;t.get(r).success(function(t){habers=null;n.yorumlar=t.yorumList.reverse();n.kisiler=t.userNameList.reverse();n.activeHaber=t.newsList}).error(function(n){console.log(n)})};n.uploadComment=function(){var r=new FormData,i,u;r.append("yorumIcerik",n.$$childTail.yorumIcerik);r.append("haberID",n.activeHaber[0].haberID);t.post("/Haberimdesin/CreateComment",r,{transformRequest:angular.identity,headers:{"Content-Type":undefined}}).success(function(n){console.log(n)}).error(function(n){console.log(n)});i=jQuery.extend({},n.yorumlar[0]);i.content=n.$$childTail.yorumIcerik;i.like=0;i.dislike=0;i.timeStamp=new Date;i.commentID=i.commentID+1;n.yorumlar.splice(0,0,i);u=n.activeHaber[0].user.name+" "+n.activeHaber[0].user.surname;n.kisiler.splice(0,0,u)}}]);HaberimdesinApp.controller("addNewsController",["$scope","$http","$q",function(n,t,i){function r(){return i(function(n,t){if(navigator.geolocation)navigator.geolocation.watchPosition(function(t){return lat=t.coords.latitude,longi=t.coords.longitude,n({lat:lat,longi:longi})},function(n){switch(n.code){case n.PERMISSION_DENIED:return t({error:"User denied the request for Geolocation."});case n.POSITION_UNAVAILABLE:return t({error:"Location information is unavailable."});case n.TIMEOUT:return t({error:"The request to get user location timed out."});case n.UNKNOWN_ERROR:return t({error:"An unknown error occurred."})}});else return t({error:"Browser Not Support"})})}n.haberHeader="";n.haberHeadline="";n.haberDetail="";n.imageFiles=[];n.date=new Date;t.get("/haberimdesin/getCategories").success(function(t){n.data={model:null,availableOptions:t.categories}}).error(function(n){console.log(n)});n.uploadNews=function(){r().then(function(i){var u=n.imageFiles,r=new FormData;for(var f in u)r.append("file[]",u[f]);r.append("haberHeader",n.haberHeader);r.append("haberHeadline",n.haberHeadline);r.append("haberDetail",n.haberDetail);r.append("latitude",i.lat);r.append("longitude",i.longi);r.append("CategoryID",n.data.model);t.post("/Haberimdesin/CreateNews",r,{transformRequest:angular.identity,headers:{"Content-Type":undefined}}).success(function(n){console.log(n+"oldu");window.location.assign("/Home/Index")}).error(function(n){console.log(n)})},function(){console.log(res)})}}]);HaberimdesinApp.directive("fileModel",["$parse",function(n){return{restrict:"A",link:function(t,i,r){var f=n(r.fileModel),u=f.assign,e=r.multiple;i.bind("change",function(){t.$apply(function(){if(e){var n=i[0].files;u(t,n)}else u(t,i[0].files[0])})})}}}]);